<div class="p-6">
  <h2 class="text-2xl font-bold mb-6 text-gray-800 border-b pb-2">
    Métricas de Evaluación del Clustering
  </h2>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- SSE -->
    <div class="bg-white rounded-xl shadow border p-5 relative">
      <p class="text-sm text-gray-500 mb-1 flex items-center gap-1">
        Suma de Errores al Cuadrado (SSE)
        <span class="group relative inline-block">
          <button
            class="w-4 h-4 rounded-full bg-blue-100 text-blue-700 text-xs flex items-center justify-center"
            aria-label="Información sobre SSE"
          >
            ?
          </button>
          <div
            class="absolute z-10 hidden group-hover:block w-64 text-xs text-gray-700 bg-white border rounded-lg shadow-lg p-3 top-full left-1/2 -translate-x-1/2 mt-1"
          >
            Es la <strong>Suma de Errores al Cuadrado</strong> (también llamada
            <em>inercia</em>).<br /><br />
            Mide qué tan cerca están los puntos de su centroide (centro del
            cluster).<br /><br />
            Entre menor sea, mejor ajustados están los datos a sus clusters.
          </div>
        </span>
      </p>
      <p class="text-xl font-semibold text-gray-900">
        {{ metricas?.sse | number : "1.2-2" }}
      </p>
    </div>

    <!-- Silhouette Score -->
    <div class="bg-white rounded-xl shadow border p-5 relative">
      <p class="text-sm text-gray-500 mb-1 flex items-center gap-1">
        Silhouette Score Promedio
        <span class="group relative inline-block">
          <button
            class="w-4 h-4 rounded-full bg-blue-100 text-blue-700 text-xs flex items-center justify-center"
            aria-label="Información sobre Silhouette Score"
          >
            ?
          </button>
          <div
            class="absolute z-10 hidden group-hover:block w-64 text-xs text-gray-700 bg-white border rounded-lg shadow-lg p-3 top-full left-1/2 -translate-x-1/2 mt-1"
          >
            Mide qué tan bien separados están los clusters entre sí.<br /><br />
            Los valores van de -1 a 1.<br /><br />
            Valores más cercanos a 1 indican mejor separación y coherencia.
          </div>
        </span>
      </p>
      <p class="text-xl font-semibold text-gray-900">
        {{ metricas?.silhouette_score_promedio | number : "1.3-3" }}
      </p>
    </div>

    <!-- Mejor k sugerido -->
    <div class="bg-white rounded-xl shadow border p-5 relative">
      <p class="text-sm text-gray-500 mb-1 flex items-center gap-1">
        Mejor k sugerido
        <span class="group relative inline-block">
          <button
            class="w-4 h-4 rounded-full bg-blue-100 text-blue-700 text-xs flex items-center justify-center"
            aria-label="Información sobre mejor k"
          >
            ?
          </button>
          <div
            class="absolute z-10 hidden group-hover:block w-64 text-xs text-gray-700 bg-white border rounded-lg shadow-lg p-3 top-full left-1/2 -translate-x-1/2 mt-1"
          >
            Es el número óptimo de clusters estimado por el modelo.<br /><br />
            Suele calcularse usando el codo (SSE) o el Silhouette Score.
          </div>
        </span>
      </p>
      <p class="text-xl font-semibold text-gray-900">
        {{ metricas?.mejor_k_sugerido }}
      </p>
    </div>

    <!-- Interpretación general -->
    <div class="bg-white rounded-xl shadow border p-5 relative">
      <p class="text-sm text-gray-500 mb-1 flex items-center gap-1">
        Calidad del Clustering
        <span class="group relative inline-block">
          <button
            class="w-4 h-4 rounded-full bg-blue-100 text-blue-700 text-xs flex items-center justify-center"
            aria-label="Información sobre calidad"
          >
            ?
          </button>
          <div
            class="absolute z-10 hidden group-hover:block w-64 text-xs text-gray-700 bg-white border rounded-lg shadow-lg p-3 top-full left-1/2 -translate-x-1/2 mt-1"
          >
            Interpreta la calidad general del clustering combinando métricas
            como SSE y Silhouette Score.<br /><br />
            Ayuda a identificar si los clusters son útiles y están bien
            definidos.
          </div>
        </span>
      </p>
      <p class="text-md font-semibold text-blue-700">
        {{ metricas?.calidad_clustering?.interpretacion }}
      </p>
    </div>
  </div>

  <!-- Estado general -->
  <div class="mt-8 bg-white rounded-xl shadow border p-5">
    <h3 class="text-lg font-semibold text-gray-700 mb-3">Estado general</h3>
    <ul class="list-disc list-inside text-sm space-y-1">
      <li
        [ngClass]="{
          'text-green-600 font-semibold':
            metricas?.calidad_clustering?.excelente,
          'text-gray-400': !metricas?.calidad_clustering?.excelente
        }"
      >
        Excelente
      </li>
      <li
        [ngClass]="{
          'text-blue-600 font-semibold': metricas?.calidad_clustering?.buena,
          'text-gray-400': !metricas?.calidad_clustering?.buena
        }"
      >
        Buena
      </li>
      <li
        [ngClass]="{
          'text-yellow-600 font-semibold':
            metricas?.calidad_clustering?.aceptable,
          'text-gray-400': !metricas?.calidad_clustering?.aceptable
        }"
      >
        Aceptable
      </li>
      <li
        [ngClass]="{
          'text-red-600 font-semibold': metricas?.calidad_clustering?.pobre,
          'text-gray-400': !metricas?.calidad_clustering?.pobre
        }"
      >
        Pobre
      </li>
    </ul>
  </div>
</div>
