<!-- Panel de resumen PCA -->
<div class="mb-6 bg-white p-4 rounded-xl border shadow-sm">
  <h3 class="text-md font-semibold text-gray-700 mb-2">Resumen PCA</h3>
  <ul class="text-sm text-gray-700 space-y-1">
    <li *ngIf="varianzaExplicada.length >= 2">
      • Varianza explicada PC1:
      <span class="font-medium text-blue-700">
        {{ varianzaExplicada[0] * 100 | number : "1.1-2" }}%
      </span>
    </li>
    <li *ngIf="varianzaExplicada.length >= 2">
      • Varianza explicada PC2:
      <span class="font-medium text-blue-700">
        {{ varianzaExplicada[1] * 100 | number : "1.1-2" }}%
      </span>
    </li>
    <li>
      • Varianza total explicada:
      <span class="font-medium text-green-700">
        {{ varianzaTotal * 100 | number : "1.1-2" }}%
      </span>
    </li>
  </ul>
</div>

<!-- Gráfico de dispersión PCA -->
<div class="overflow-x-auto">
  <div *ngIf="!hasValidData" class="text-center py-8 text-gray-500">
    <p>No hay datos válidos para mostrar en el gráfico de dispersión.</p>
    <p class="text-sm">Selecciona variables numéricas para ambos ejes.</p>
  </div>

  <ngx-charts-bubble-chart
    *ngIf="hasValidData"
    [view]="view"
    [results]="bubbleChartData"
    [xAxis]="true"
    [yAxis]="true"
    [legend]="true"
    [showXAxisLabel]="true"
    [showYAxisLabel]="true"
    xAxisLabel="PC1 ({{ varianzaExplicada[0] * 100 | number : '1.1-2' }}%)"
    yAxisLabel="PC2 ({{ varianzaExplicada[1] * 100 | number : '1.1-2' }}%)"
    [minRadius]="8"
    [maxRadius]="25"
    [xScaleMin]="xScaleMin"
    [xScaleMax]="xScaleMax"
    [yScaleMin]="yScaleMin"
    [yScaleMax]="yScaleMax"
    [scheme]="colorScheme"
    (select)="onSelect($event)"
  >
  </ngx-charts-bubble-chart>
</div>
